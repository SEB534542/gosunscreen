<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sunscreen configuration</title>
</head>
<body>
{{range .Msgs}}
	<i>{{.}}</i><br>
{{end}}
<h1>Configuration</h1>

<p><a href="/">Click here to go back to home</a></p>
<p><a href="/config/add">Click here to go set-up a sunscreen</a></p>

{{range .Site.Sunscreens}}	
	<h2>Sunscreen {{.Name}}</h2>
	<form action="/config/{{.Id}}" method="POST">
		<table>
			<tr>
				<td><label for="Name">Sunscreen Name</label></td>
				<td><input type="text" name="Name" value="{{.Name}}" required></td>
			</tr>
			<tr>
				<td><label for="Start">Start time (hh:mm)</label></td>
				<td><input type="time" name="Start" value="{{fdateHM .Start}}" required></td>
			</tr>
			<tr>
				<td><label for="Stop">Stop time (hh:mm)</label></td>
				<td><input type="time" name="Stop" value="{{fdateHM .Stop}}" required></td>
			</tr>
			<tr>
				<td><label for="StopThreshold">Stop Threshold (in minutes)</label></td>
				<td><input type="number" name="StopThreshold" value="{{fminutes .StopThreshold}}" required></td>
			</tr>
			<tr>
				<td><label for="DurDown">Seconds down</label></td>
				<td><input type="number" name="DurDown" value="{{fseconds .DurDown}}" required></td>
			</tr>
			<tr>
				<td><label for="DurUp">Seconds up</label></td>
				<td><input type="number" name="DurUp" value="{{fseconds .DurUp}}" required></td>
			</tr>
			<tr>
				<td><label for="PinDown">Pin for down</label></td>
				<td><input type="number" name="PinDown" value="{{.PinDown}}" required></td>
			</tr>
			<tr>
				<td><label for="PinUp">Pin for up</label></td>
				<td><input type="number" name="PinUp" value="{{.PinUp}}" required></td>
			</tr>
		</table>
		<br>
		<input type="submit" value="Save {{.Name}}">
	</form>
{{end}}

<h2>Light sensor</h2>
<form method="POST">
	<table>
		<tr>
			<td><label for="PinLight">Pin for up</label></td>
			<td><input type="number" name="PinLight" value="{{.Site.LightSensor.PinLight}}" required></td>
		</tr>
		<tr>
			<td><label for="AllowedOutliers">AllowedOutliers (Number of times)</label></td>
			<td><input type="number" name="AllowedOutliers" value="{{.Site.LightSensor.AllowedOutliers}}" required></td>
		</tr>
    		<tr>
			<td><label for="Interval">Interval in seconds</label></td>
			<td><input type="number" name="Interval" value="{{.Site.LightSensor.Interval}}" required></td>
		</tr>
		<tr>
			<td><label for="LightFactor">Analog value correction</label></td>
			<td><input type="number" name="LightFactor" value="{{.Site.LightSensor.LightFactor}}" required></td>
		</tr>
		<tr>
        <td></td><td>Good</td><td>Neutral</td><td>Bad</td>
      	</tr>
      	<tr>
      		<td>Value</td>
        	<td><input type="number" name="LightGoodValue" value="{{.Site.LightSensor.LightGoodValue}}" required></td>
        	<td><input type="number" name="LightNeutralValue" value="{{.Site.LightSensor.LightNeutralValue}}" required></td>
        	<td><input type="number" name="LightBadValue" value="{{.Site.LightSensor.LightBadValue}}" required></td>
      	</tr> 
		<tr></tr>
     	<tr>
	        <td>Threshold</td>
	        <td><input type="number" name="LightGoodThreshold" value="{{.Site.LightSensor.LightGoodThreshold}}" required></td>
	        <td><input type="number" name="LightNeutralThreshold" value="{{.Site.LightSensor.LightNeutralThreshold}}" required></td>
	        <td><input type="number" name="LightBadThreshold" value="{{.Site.LightSensor.LightBadThreshold}}" required></td>
		</tr>
	<table>
	<h2>Settings</h2>
	<table>
		<tr>
			<td><b>Advanced</b></td>
			<td><label for="RefreshRate">Website refresh rate (in minutes)</label></td>
			<td><input type="number" name="RefreshRate" value="{{fminutes .Config.RefreshRate}}" required></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="MoveHistory">Number of historical Movements</label></td>
			<td><input type="number" name="MoveHistory" value="{{.Config.MoveHistory}}" required></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="LogRecords">Number Log records shown</label></td>
			<td><input type="number" name="LogRecords" value="{{.Config.LogRecords}}" required></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="IpWhitelist">Whitelisted IPs (comma separated)</label></td>
			<td><input type="text" name="IpWhitelist" value="{{fsliceString .Config.IpWhitelist}}"></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="Port">Port (range: 1000-9999; requires reboot)</label></td>
			<td><input type="text" name="Port" value="{{.Config.Port}}"></td>
		</tr>
		
		<tr>
			<td><b>E-mail</b></td>
			<td><label for="EnableMail">EnableMail</label></td>
			<td><input type="checkbox" name="EnableMail" value=true {{if eq .Config.EnableMail true}} checked {{end}}></td>		
		</tr>
		
		<tr>
			<td><b>Login</b></td>
			<td><label for="Username">Username</label></td>
			<td><input type="text" name="Username" value="{{.Config.Username}}" required></td>
		</tr>		
		<tr>
			<td></td>
			<td><label for="CurrentPassword">Current Password</label></td>
			<td><input type="password" name="CurrentPassword"></td>
		</tr>		
		<tr>
			<td></td>
			<td><label for="Password">Password</label></td>
			<td><input type="password" name="Password"></td>
		</tr>		
	</table>
	<br>
	<input type="submit" value="Save settings"><br>
</form>

<p><a href="/">Click here to go back to home</a></p>

</body>
</html>
