<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sunscreen configuration</title>
</head>
<body>
{{range .Msgs}}
	<i>{{.}}</i><br>
{{end}}
<h1>Configuration</h1>

<p><a href="/">Click here to go back to home</a></p>
<p><a href="/config/add">Click here to go set-up a sunscreen</a></p>

{{range .Site.Sunscreens}}	
	<h2>Sunscreen {{.Name}}</h2>
	<form action="/config/edit/{{.Id}}" method="POST">
		{{template "addSunscreen" .}}
	</form>
	<!--<a href=delete/{{.Id}}><button>Delete {{.Name}}</button></a>-->
{{end}}

<h2>Light sensor</h2>
<form method="POST">
	<table>
		<tr>
			<td><label for="PinLight">Pin for up</label></td>
			<td><input type="number" name="PinLight" value="{{.Site.LightSensor.PinLight}}" required></td>
		</tr>
		<tr>
			<td><label for="AllowedOutliers">AllowedOutliers (Number of times)</label></td>
			<td><input type="number" name="AllowedOutliers" value="{{.Site.LightSensor.AllowedOutliers}}" required></td>
		</tr>
    		<tr>
			<td><label for="Interval">Interval in seconds</label></td>
			<td><input type="number" name="Interval" value="{{fseconds .Site.LightSensor.Interval}}" required></td>
		</tr>
		<tr>
			<td><label for="LightFactor">Analog value correction</label></td>
			<td><input type="number" name="LightFactor" value="{{.Site.LightSensor.LightFactor}}" required></td>
		</tr>
		<tr>
        <td></td><td>Good</td><td>Neutral</td><td>Bad</td>
      	</tr>
      	<tr>
      		<td>Value</td>
        	<td><input type="number" name="LightGoodValue" value="{{.Site.LightSensor.LightGoodValue}}" required></td>
        	<td><input type="number" name="LightNeutralValue" value="{{.Site.LightSensor.LightNeutralValue}}" required></td>
        	<td><input type="number" name="LightBadValue" value="{{.Site.LightSensor.LightBadValue}}" required></td>
      	</tr> 
		<tr></tr>
     	<tr>
	        <td>Threshold</td>
	        <td><input type="number" name="LightGoodThreshold" value="{{.Site.LightSensor.LightGoodThreshold}}" required></td>
	        <td><input type="number" name="LightNeutralThreshold" value="{{.Site.LightSensor.LightNeutralThreshold}}" required></td>
	        <td><input type="number" name="LightBadThreshold" value="{{.Site.LightSensor.LightBadThreshold}}" required></td>
		</tr>
	<table>
	<h2>Settings</h2>
	<table>
		<tr>
			<td><b>Advanced</b></td>
			<td><label for="RefreshRate">Website refresh rate (in minutes)</label></td>
			<td><input type="number" name="RefreshRate" value="{{fminutes .Config.RefreshRate}}" required></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="MoveHistory">Number of historical Movements</label></td>
			<td><input type="number" name="MoveHistory" value="{{.Config.MoveHistory}}" required></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="LogRecords">Number Log records shown</label></td>
			<td><input type="number" name="LogRecords" value="{{.Config.LogRecords}}" required></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="IpWhitelist">Whitelisted IPs (comma separated)</label></td>
			<td><input type="text" name="IpWhitelist" value="{{fsliceString .Config.IpWhitelist}}"></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="Port">Port (range: 1000-9999; requires reboot)</label></td>
			<td><input type="text" name="Port" value="{{.Config.Port}}"></td>
		</tr>
		
		<tr>
			<td><b>E-mail</b></td>
			<td><label for="EnableMail">EnableMail</label></td>
			<td><input type="checkbox" name="EnableMail" value=true {{if eq .Config.EnableMail true}} checked {{end}}></td>		
		</tr>
		<tr>
			<td></td>
			<td><label for="MailFrom">E-mail Address</label></td>
			<td><input type="email" name="MailFrom" value={{.Config.MailFrom}}></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="MailUser">E-mail Username</label></td>
			<td><input type="text" name="MailUser" value={{.Config.MailUser}}></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="MailPass">E-mail Password</label></td>
			<td><input type="password" name="MailPass"></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="MailHost">E-mail host</label></td>
			<td><input type="text" name="MailHost" value={{.Config.MailHost}}></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="MailPort">E-mail host port</label></td>
			<td><input type="number" name="MailPort" value={{.Config.MailPort}}></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="MailTo">E-mail recipients (comma separated)</label></td>
			<td><input type="text" name="MailTo" value={{fsliceString .Config.MailTo}}></td>
		</tr>
		<tr>
			<td><b>Login</b></td>
			<td><label for="Username">Username</label></td>
			<td><input type="text" name="Username" value="{{.Config.Username}}" required></td>
		</tr>		
		<tr>
			<td></td>
			<td><label for="CurrentPassword">Current Password</label></td>
			<td><input type="password" name="CurrentPassword"></td>
		</tr>		
		<tr>
			<td></td>
			<td><label for="Password">Password</label></td>
			<td><input type="password" name="Password"></td>
		</tr>	
		<tr>
			<td><b>Location</b></td>
			<td><label for="Latitude">Latitude</label></td>
			<td><input type="number" name="Latitude" step=any value="{{.Config.Location.Latitude}}"></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="Longitude">Longitude</label></td>
			<td><input type="number" name="Longitude" step=any value="{{.Config.Location.Longitude}}"></td>
		</tr>
		<tr>
			<td></td>
			<td><label for="UtcOffset">UtcOffset</label></td>
			<td><input type="number" name="UtcOffset" value="{{.Config.Location.UtcOffset}}"></td>
		</tr>			
	</table>
	<br>
	<input type="submit" value="Save"><br>
</form>

<p><a href="/">Click here to go back to home</a></p>

</body>
</html>
